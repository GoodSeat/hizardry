module UI.CuiRender where

import Control.Monad
import Data.List (isPrefixOf)

import Control.CUI
import Engine.GameAuto
import Data.Primitive
import Data.Characters as Character
import Data.World
import Data.Maze
import qualified Data.Enemies as Enemy
import qualified Data.Items as Item


windowW = 75
windowH = 40

render :: Craphic -> IO ()
render = draw (windowW, windowH)

txts :: Craphic -> [String]
txts c = do
  l <- [1..windowH]
  return $ concat [show $ at c (col, l) | col <- [1..windowW]]

msgBox :: String -> Craphic
msgBox m = foldl1 (<>) (fmap toText (zip [1..] ls))
        <> rect (8, 5) (61, length ls + 2) (Draw ' ')
  where
    ls = lines m
    toText (n, t) = text (9, 5 + n) t

cmdBox :: String -> Craphic
cmdBox m = foldl1 (<>) (fmap toText (zip [1..] ls))
        <> rect (45, 15) (26, 10) (Draw ' ')
  where
    ls = lines m
    toText (n, t) = text (46, 15 + n) t


status :: [Character] -> Craphic
status p = foldl1 (<>) $ fmap toStatusLine (zip [1..] p) ++
    [text (6, windowH - 7) "#--CHARACTER NAME-------------CLASS-----AC----HITS---STATUS"
    ,rect (5, windowH - 7) (67, 8) (Draw ' ')]
  where
    toStatusLine (n, c) =  text (6,  windowH - 7 + n) (show n ++ "  " ++ name c)
                        <> text (36, windowH - 7 + n) (show (alignment c) ++ "-" ++ take 3 (jobName $ job c))
                        <> text (46, windowH - 7 + n) (show $ acOf c)
                        <> text (54, windowH - 7 + n) (show $ hp c)
                        <> text (61, windowH - 7 + n) (show $ maxhp c)

statusView :: String -> (ItemID -> Bool -> Item.Name)  -> Maybe Character -> Craphic
statusView _ _ Nothing  = undefined
statusView msg itemNameOf (Just c) =
    foldl1 (<>) (fmap toText (zip [1..] ls)) <>
    rect (8, 24) (61, 7) (Draw ' ') <>
    ( translate (5, 4) $
      fromTexts ' ' $ replaceText "[Name]" (name c) (Left 30)
                    . replaceText "[Lv]"    (show $ lv c)            (Right 4)
                    . replaceText "[STR]"   (show $ strength st)     (Right 3)
                    . replaceText "[IQ]"    (show $ iq st)           (Right 3)
                    . replaceText "[PIE]"   (show $ piety st)        (Right 3)
                    . replaceText "[VIT]"   (show $ vitality st)     (Right 3)
                    . replaceText "[AGI]"   (show $ agility st)      (Right 3)
                    . replaceText "[LUK]"   (show $ luck st)         (Right 3)
                    . replaceText "[HP]"    (show $ hp c)            (Right 4)
                    . replaceText "[MaxHP]" (show $ maxhp c)         (Right 4)
                    . replaceText "[Exp]"   (show $ Character.exp c) (Right 8)
                    . replaceText "[Gold]"  (show $ gold c)          (Right 8)
                    . replaceText "[Age]"   (show $ age c)           (Right 4)
                    . replaceText "[AC]"    (show $ acOf c)          (Right 4)
                    . replaceText "[Marks]" (show $ marks c)         (Right 4)
                    . replaceText "[RIPs]"  (show $ rips c)          (Right 4)
                    . replaceText "M1"  (show $ (fst (mp c) ++ repeat 0) !! 0) (Right 2)
                    . replaceText "M2"  (show $ (fst (mp c) ++ repeat 0) !! 1) (Right 2)
                    . replaceText "M3"  (show $ (fst (mp c) ++ repeat 0) !! 2) (Right 2)
                    . replaceText "M4"  (show $ (fst (mp c) ++ repeat 0) !! 3) (Right 2)
                    . replaceText "M5"  (show $ (fst (mp c) ++ repeat 0) !! 4) (Right 2)
                    . replaceText "M6"  (show $ (fst (mp c) ++ repeat 0) !! 5) (Right 2)
                    . replaceText "M7"  (show $ (fst (mp c) ++ repeat 0) !! 6) (Right 2)
                    . replaceText "P1"  (show $ (snd (mp c) ++ repeat 0) !! 0) (Right 2)
                    . replaceText "P2"  (show $ (snd (mp c) ++ repeat 0) !! 1) (Right 2)
                    . replaceText "P3"  (show $ (snd (mp c) ++ repeat 0) !! 2) (Right 2)
                    . replaceText "P4"  (show $ (snd (mp c) ++ repeat 0) !! 3) (Right 2)
                    . replaceText "P5"  (show $ (snd (mp c) ++ repeat 0) !! 4) (Right 2)
                    . replaceText "P6"  (show $ (snd (mp c) ++ repeat 0) !! 5) (Right 2)
                    . replaceText "P7"  (show $ (snd (mp c) ++ repeat 0) !! 6) (Right 2)
                    . replaceText "[Item1]"  (items' !! 0) (Left 24)
                    . replaceText "[Item2]"  (items' !! 1) (Left 24)
                    . replaceText "[Item3]"  (items' !! 2) (Left 24)
                    . replaceText "[Item4]"  (items' !! 3) (Left 24)
                    . replaceText "[Item5]"  (items' !! 4) (Left 24)
                    . replaceText "[Item6]"  (items' !! 5) (Left 24)
                    . replaceText "[Item7]"  (items' !! 6) (Left 24)
                    . replaceText "[Item8]"  (items' !! 7) (Left 24)
                    . replaceText "[Item9]"  (items' !! 8) (Left 24)
                    . replaceText "[Item0]"  (items' !! 9) (Left 24)
                    $ statusViewPlaceHolder) <> rect (6, 4) (65, 22) (Draw ' ')
  where
    st = paramOf c
    ls = lines msg
    toText (n, t) = text (11, 25 + n) t
    items' = ((\(ItemInf id identified) -> itemNameOf id identified) <$> Character.items c) ++ repeat ""


replaceText :: String -> String -> Either Int Int -> [String] -> [String]
replaceText src dst align ls = replaceLine src dst align <$> ls

replaceLine :: String -> String -> Either Int Int -> String -> String
replaceLine src dst align = rep src' dst''
  where
    dst'  = case align of Left  i -> fill (i - length dst) dst False
                          Right i -> fill (i - length dst) dst True
    n'    = max (length src) (length dst')
    dst'' = take n' $ dst' ++ repeat ' '
    src'  = take n' $ src  ++ repeat ' '
    fill 0 s _ = s
    fill n s toL = if toL then ' ' : fill (n - 1) s toL else fill (n - 1) s toL ++ " "

rep :: Eq a => [a] -> [a] -> [a] -> [a]
rep _   _  [] = []
rep src dst s = if src `isPrefixOf` s then dst ++ rep src dst (drop (length src) s) else head s : rep src dst (tail s)


statusViewPlaceHolder =
  ["                                                                 "  --   1
  ,"    [Name]                          Lv [Lv]           [KAJ]      "  --   2
  ,"                                                                 "  --   3
  ,"                         HP : [HP]/[MaxHP]  Status : [Status]    "  --   4
  ,"      STR :[STR]                                                 "  --   5
  ,"       IQ :[IQ]         Exp : [Exp]            Age : [Age]       "  --   6
  ,"      PIE :[PIE]       Next : [Next]            AC : [AC]        "  --   7
  ,"      VIT :[VIT]       Gold : [Gold]         Marks : [Marks]     "  --   8
  ,"      AGI :[AGI]                              RIPs : [RIPs]      "  --   9
  ,"      LUK :[LUK]                                                 "  --   10
  ,"                         Spell M:M1/M2/M3/M4/M5/M6/M7            "  --   11
  ,"                               P:P1/P2/P3/P4/P5/P6/P7            "  --   12
  ,"                                                                 "  --   13
  ,"    A) [Item1]                    F) [Item6]                     "  --   14
  ,"    B) [Item2]                    G) [Item7]                     "  --   15
  ,"    C) [Item3]                    H) [Item8]                     "  --   16
  ,"    D) [Item4]                    I) [Item9]                     "  --   17
  ,"    E) [Item5]                    J) [Item0]                     "  --   18
  ]
--  12345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6      



scene :: Place -> Scenario -> Craphic
scene (InMaze p)            = dunsion p
scene (Camping p)           = dunsion p
scene (InBattle p _)        = dunsion p
scene (FindTreasureChest p) = dunsion p
scene InCastle              = const $ translate (0, 2) city2
scene InEdgeOfTown          = const $ translate (0, 2) edgeOfTown
scene Gilgamesh'sTarvern    = const $ translate (0, 2) tarvern
scene _ = const mempty

dunsion :: Position -> Scenario -> Craphic
dunsion p scenario = foldl1 mappend $ front <$> [(d, s) | d <-[0..1], s <- [(-1)..1]]
  where
    m = mazes scenario !! z p
    front (d, s) = sw <> fw <> upn <> dwn
      where
        fw = case visiblityAt m p d s F of
                 Wall -> frontWall d s
                 Door -> frontDoor d s
                 _    -> mempty
        sw = if s == 0 then mempty
             else let (side, s') = if s > 0 then (R, s - 1) else (L, s + 1) in
                 case visiblityAt m p d s' side of
                     Wall -> sideWall d s
                     Door -> sideDoor d s
                     _    -> mempty
        nots = noticesInView m p d s
        upn = if Up   `elem` nots then upNotice   d s else mempty
        dwn = if Down `elem` nots then downNotice d s else mempty

-- ========================================================================

frame :: Craphic
frame = fromTexts '*'
  ["                                                                           "  --   1
  ," +-----------------------------------------------------------------------+ "  --   2
  ," |***********************************************************************| "  --   3
  ," |***********************************************************************| "  --   4
  ," |***********************************************************************| "  --   5
  ," |***********************************************************************| "  --   6
  ," |***********************************************************************| "  --   7
  ," |***********************************************************************| "  --   8
  ," |***********************************************************************| "  --   9
  ," |***********************************************************************| "  --  10
  ," |***********************************************************************| "  --  11
  ," |***********************************************************************| "  --  12
  ," |***********************************************************************| "  --  13
  ," |***********************************************************************| "  --  14
  ," |***********************************************************************| "  --  15
  ," |***********************************************************************| "  --  16
  ," |***********************************************************************| "  --  17
  ," |***********************************************************************| "  --  18
  ," |***********************************************************************| "  --  19
  ," |***********************************************************************| "  --  20
  ," |***********************************************************************| "  --  21
  ," |***********************************************************************| "  --  22
  ," |***********************************************************************| "  --  23
  ," |***********************************************************************| "  --  24
  ," |***********************************************************************| "  --  25
  ," |***********************************************************************| "  --  26
  ," |***********************************************************************| "  --  27
  ," |***********************************************************************| "  --  28
  ," |***********************************************************************| "  --  29
  ," |***********************************************************************| "  --  30
  ," |***********************************************************************| "  --  31
  ," |***********************************************************************| "  --  32
  ," |***********************************************************************| "  --  33
  ," |***********************************************************************| "  --  34
  ," |***********************************************************************| "  --  35
  ," |***********************************************************************| "  --  36
  ," |***********************************************************************| "  --  37
  ," |***********************************************************************| "  --  38
  ," +-----------------------------------------------------------------------+ "  --  39
  ,"                                                                           "] --  40
guide :: Craphic
guide = fromTexts '*'
  ["*********+-------------------------------------------------------+********"  --  1
  ,"*********|   C)AMP  S)TATUS  I)NSPECT  Q)UIT  O)FF   A-W-D   K   |********"  --  2
  ,"*********+-------------------------------------------------------+********"] --  3

revC = windowW `div` 2 + 1
-- ========================================================================
-- Position index:
--
--   <> Front wall     <> Side wall
--                    
-- depth             depth            
--    2  -- -- --         -- -- --
--         |  |        2 |  |  |  |
--    1  -- -- --         -- -- --
--         |  |        1 |  |  |  |
--    0  -- -- --         -- -- --
--         |@ |        0 |  |@ |  |
--                           
-- side  -1  0 +1       -2 -1 +1 +2
--
--
frontWall :: Int    -- ^ distance of depth.
          -> Int    -- ^ distance of side.
          -> Craphic
frontWall 0 0 = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"*************+-----------------------------------------------+*************"  --   6
  ,"*************|                                               |*************"  --   7
  ,"*************|                                               |*************"  --   8
  ,"*************|                                               |*************"  --   9
  ,"*************|                                               |*************"  --  10
  ,"*************|                                               |*************"  --  11
  ,"*************|                                               |*************"  --  12
  ,"*************|                                               |*************"  --  13
  ,"*************|                                               |*************"  --  14
  ,"*************|                                               |*************"  --  15
  ,"*************|                                               |*************"  --  16
  ,"*************|                                               |*************"  --  17
  ,"*************|                                               |*************"  --  18
  ,"*************|                                               |*************"  --  19
  ,"*************|                                               |*************"  --  20
  ,"*************|                                               |*************"  --  21
  ,"*************|                                               |*************"  --  22
  ,"*************|                                               |*************"  --  23
  ,"*************|                                               |*************"  --  24
  ,"*************|                                               |*************"  --  25
  ,"*************|                                               |*************"  --  26
  ,"*************|                                               |*************"  --  27
  ,"*************|                                               |*************"  --  28
  ,"*************|                                               |*************"  --  29
  ,"*************|                                               |*************"  --  30
  ,"*************|                                               |*************"  --  31
  ,"*************|                                               |*************"  --  32
  ,"*************|                                               |*************"  --  33
  ,"*************|                                               |*************"  --  34
  ,"*************|                                               |*************"  --  35
  ,"*************|_______________________________________________|*************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40
frontWall 0  1   = reverseH revC $ frontWall 0 (-1)
frontWall 0 (-1) = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"-------------+*************************************************************"  --   6
  ,"             |*************************************************************"  --   7
  ,"             |*************************************************************"  --   8
  ,"             |*************************************************************"  --   9
  ,"             |*************************************************************"  --  10
  ,"             |*************************************************************"  --  11
  ,"             |*************************************************************"  --  12
  ,"             |*************************************************************"  --  13
  ,"             |*************************************************************"  --  14
  ,"             |*************************************************************"  --  15
  ,"             |*************************************************************"  --  16
  ,"             |*************************************************************"  --  17
  ,"             |*************************************************************"  --  18
  ,"             |*************************************************************"  --  19
  ,"             |*************************************************************"  --  20
  ,"             |*************************************************************"  --  21
  ,"             |*************************************************************"  --  22
  ,"             |*************************************************************"  --  23
  ,"             |*************************************************************"  --  24
  ,"             |*************************************************************"  --  25
  ,"             |*************************************************************"  --  26
  ,"             |*************************************************************"  --  27
  ,"             |*************************************************************"  --  28
  ,"             |*************************************************************"  --  29
  ,"             |*************************************************************"  --  30
  ,"             |*************************************************************"  --  31
  ,"             |*************************************************************"  --  32
  ,"             |*************************************************************"  --  33
  ,"             |*************************************************************"  --  34
  ,"             |*************************************************************"  --  35
  ,"_____________|*************************************************************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40
frontWall 1 0 = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"***************************************************************************"  --   6
  ,"***************************************************************************"  --   7
  ,"***************************************************************************"  --   8
  ,"***************************************************************************"  --   9
  ,"***************************************************************************"  --  10
  ,"***************************************************************************"  --  11
  ,"***************************************************************************"  --  12
  ,"***************************************************************************"  --  13
  ,"***************************************************************************"  --  14
  ,"**********************+-----------------------------+**********************"  --  15
  ,"**********************|                             |**********************"  --  16
  ,"**********************|                             |**********************"  --  17
  ,"**********************|                             |**********************"  --  18
  ,"**********************|                             |**********************"  --  19
  ,"**********************|                             |**********************"  --  20
  ,"**********************|                             |**********************"  --  21
  ,"**********************|                             |**********************"  --  22
  ,"**********************|                             |**********************"  --  23
  ,"**********************|                             |**********************"  --  24
  ,"**********************|                             |**********************"  --  25
  ,"**********************|                             |**********************"  --  26
  ,"**********************|                             |**********************"  --  27
  ,"**********************|                             |**********************"  --  28
  ,"**********************|                             |**********************"  --  29
  ,"**********************|                             |**********************"  --  30
  ,"**********************|_____________________________|**********************"  --  31
  ,"***************************************************************************"  --  32
  ,"***************************************************************************"  --  33
  ,"***************************************************************************"  --  34
  ,"***************************************************************************"  --  35
  ,"***************************************************************************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40
frontWall 1   1  = reverseH revC $ frontWall 1 (-1)
frontWall 1 (-1) = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"***************************************************************************"  --   6
  ,"***************************************************************************"  --   7
  ,"***************************************************************************"  --   8
  ,"***************************************************************************"  --   9
  ,"***************************************************************************"  --  10
  ,"***************************************************************************"  --  11
  ,"***************************************************************************"  --  12
  ,"***************************************************************************"  --  13
  ,"***************************************************************************"  --  14
  ,"----------------------+****************************************************"  --  15
  ,"                      |****************************************************"  --  16
  ,"                      |****************************************************"  --  17
  ,"                      |****************************************************"  --  18
  ,"                      |****************************************************"  --  19
  ,"                      |****************************************************"  --  20
  ,"                      |****************************************************"  --  21
  ,"                      |****************************************************"  --  22
  ,"                      |****************************************************"  --  23
  ,"                      |****************************************************"  --  24
  ,"                      |****************************************************"  --  25
  ,"                      |****************************************************"  --  26
  ,"                      |****************************************************"  --  27
  ,"                      |****************************************************"  --  28
  ,"                      |****************************************************"  --  29
  ,"                      |****************************************************"  --  30
  ,"______________________|****************************************************"  --  31
  ,"***************************************************************************"  --  32
  ,"***************************************************************************"  --  33
  ,"***************************************************************************"  --  34
  ,"***************************************************************************"  --  35
  ,"***************************************************************************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40

frontWall _ _ = undefined

-- ========================================================================

frontDoor 0 0 = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"*************+-----------------------------------------------+*************"  --   6
  ,"*************|                                               |*************"  --   7
  ,"*************|                                               |*************"  --   8
  ,"*************|                                               |*************"  --   9
  ,"*************|                                               |*************"  --  10
  ,"*************|                                               |*************"  --  11
  ,"*************|                                               |*************"  --  12
  ,"*************|                                               |*************"  --  13
  ,"*************|                                               |*************"  --  14
  ,"*************|      +---------------------------------+      |*************"  --  15
  ,"*************|      |                                 |      |*************"  --  16
  ,"*************|      |                                 |      |*************"  --  17
  ,"*************|      |                                 |      |*************"  --  18
  ,"*************|      |                                 |      |*************"  --  19
  ,"*************|      |                                 |      |*************"  --  20
  ,"*************|      |                                 |      |*************"  --  21
  ,"*************|      |                                 |      |*************"  --  22
  ,"*************|      |                                 |      |*************"  --  23
  ,"*************|      |                                 |      |*************"  --  24
  ,"*************|      |                                 |      |*************"  --  25
  ,"*************|      |                                 |      |*************"  --  26
  ,"*************|      |                                 |      |*************"  --  27
  ,"*************|      |                                 |      |*************"  --  28
  ,"*************|      |                                 |      |*************"  --  29
  ,"*************|      |                                 |      |*************"  --  30
  ,"*************|      |                                 |      |*************"  --  31
  ,"*************|      |                                 |      |*************"  --  32
  ,"*************|      |                                 |      |*************"  --  33
  ,"*************|      |                                 |      |*************"  --  34
  ,"*************|      |                                 |      |*************"  --  35
  ,"*************|______|_________________________________|______|*************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40
frontDoor 0  1   = reverseH revC $ frontDoor 0 (-1)
frontDoor 0 (-1) = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"-------------+*************************************************************"  --   6
  ,"             |*************************************************************"  --   7
  ,"             |*************************************************************"  --   8
  ,"             |*************************************************************"  --   9
  ,"             |*************************************************************"  --  10
  ,"             |*************************************************************"  --  11
  ,"             |*************************************************************"  --  12
  ,"             |*************************************************************"  --  13
  ,"             |*************************************************************"  --  14
  ,"--------+    |*************************************************************"  --  15
  ,"        |    |*************************************************************"  --  16
  ,"        |    |*************************************************************"  --  17
  ,"        |    |*************************************************************"  --  18
  ,"        |    |*************************************************************"  --  19
  ,"        |    |*************************************************************"  --  20
  ,"        |    |*************************************************************"  --  21
  ,"        |    |*************************************************************"  --  22
  ,"        |    |*************************************************************"  --  23
  ,"        |    |*************************************************************"  --  24
  ,"        |    |*************************************************************"  --  25
  ,"        |    |*************************************************************"  --  26
  ,"        |    |*************************************************************"  --  27
  ,"        |    |*************************************************************"  --  28
  ,"        |    |*************************************************************"  --  29
  ,"        |    |*************************************************************"  --  30
  ,"        |    |*************************************************************"  --  31
  ,"        |    |*************************************************************"  --  32
  ,"        |    |*************************************************************"  --  33
  ,"        |    |*************************************************************"  --  34
  ,"        |    |*************************************************************"  --  35
  ,"________|____|*************************************************************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40

frontDoor 1 0 = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"***************************************************************************"  --   6
  ,"***************************************************************************"  --   7
  ,"***************************************************************************"  --   8
  ,"***************************************************************************"  --   9
  ,"***************************************************************************"  --  10
  ,"***************************************************************************"  --  11
  ,"***************************************************************************"  --  12
  ,"***************************************************************************"  --  13
  ,"***************************************************************************"  --  14
  ,"**********************+-----------------------------+**********************"  --  15
  ,"**********************|                             |**********************"  --  16
  ,"**********************|                             |**********************"  --  17
  ,"**********************|                             |**********************"  --  18
  ,"**********************|    +-------------------+    |**********************"  --  19
  ,"**********************|    |                   |    |**********************"  --  20
  ,"**********************|    |                   |    |**********************"  --  21
  ,"**********************|    |                   |    |**********************"  --  22
  ,"**********************|    |                   |    |**********************"  --  23
  ,"**********************|    |                   |    |**********************"  --  24
  ,"**********************|    |                   |    |**********************"  --  25
  ,"**********************|    |                   |    |**********************"  --  26
  ,"**********************|    |                   |    |**********************"  --  27
  ,"**********************|    |                   |    |**********************"  --  28
  ,"**********************|    |                   |    |**********************"  --  29
  ,"**********************|    |                   |    |**********************"  --  30
  ,"**********************|____|___________________|____|**********************"  --  31
  ,"***************************************************************************"  --  32
  ,"***************************************************************************"  --  33
  ,"***************************************************************************"  --  34
  ,"***************************************************************************"  --  35
  ,"***************************************************************************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40
frontDoor 1   1  = reverseH revC $ frontDoor 1 (-1)
frontDoor 1 (-1) = fromTexts '*'
  ["***************************************************************************"  --   1
  ,"***************************************************************************"  --   2
  ,"***************************************************************************"  --   3
  ,"***************************************************************************"  --   4
  ,"***************************************************************************"  --   5
  ,"***************************************************************************"  --   6
  ,"***************************************************************************"  --   7
  ,"***************************************************************************"  --   8
  ,"***************************************************************************"  --   9
  ,"***************************************************************************"  --  10
  ,"***************************************************************************"  --  11
  ,"***************************************************************************"  --  12
  ,"***************************************************************************"  --  13
  ,"***************************************************************************"  --  14
  ,"----------------------+****************************************************"  --  15
  ,"                      |****************************************************"  --  16
  ,"                      |****************************************************"  --  17
  ,"                      |****************************************************"  --  18
  ,"+-----------------+   |****************************************************"  --  19
  ,"|                 |   |****************************************************"  --  20
  ,"|                 |   |****************************************************"  --  21
  ,"|                 |   |****************************************************"  --  22
  ,"|                 |   |****************************************************"  --  23
  ,"|                 |   |****************************************************"  --  24
  ,"|                 |   |****************************************************"  --  25
  ,"|                 |   |****************************************************"  --  26
  ,"|                 |   |****************************************************"  --  27
  ,"|                 |   |****************************************************"  --  28
  ,"|                 |   |****************************************************"  --  29
  ,"|                 |   |****************************************************"  --  30
  ,"|_________________|___|****************************************************"  --  31
  ,"***************************************************************************"  --  32
  ,"***************************************************************************"  --  33
  ,"***************************************************************************"  --  34
  ,"***************************************************************************"  --  35
  ,"***************************************************************************"  --  36
  ,"***************************************************************************"  --  37
  ,"***************************************************************************"  --  38
  ,"***************************************************************************"  --  39
  ,"***************************************************************************"] --  40

frontDoor _ _ = undefined

-- ========================================================================
--
repSlash = replace (Draw '／') (Draw '＼') . replace (Draw '\\') (Draw '/')

sideWall _   0  = mempty
sideWall 0   1  = reverseH revC . repSlash $ sideWall 0 (-1)
sideWall 0 (-1) = fromTexts '*'
  ["        \\******************************************************************" --   1
  ,"         \\*****************************************************************" --   2
  ,"          \\****************************************************************" --   3
  ,"           \\***************************************************************" --   4
  ,"            \\**************************************************************" --   5
  ,"             \\*************************************************************" --   6
  ,"             |*************************************************************"  --   7
  ,"             |*************************************************************"  --   8
  ,"             |*************************************************************"  --   9
  ,"             |*************************************************************"  --  10
  ,"             |*************************************************************"  --  11
  ,"             |*************************************************************"  --  12
  ,"             |*************************************************************"  --  13
  ,"             |*************************************************************"  --  14
  ,"             |*************************************************************"  --  15
  ,"             |*************************************************************"  --  16
  ,"             |*************************************************************"  --  17
  ,"             |*************************************************************"  --  18
  ,"             |*************************************************************"  --  19
  ,"             |*************************************************************"  --  20
  ,"             |*************************************************************"  --  21
  ,"             |*************************************************************"  --  22
  ,"             |*************************************************************"  --  23
  ,"             |*************************************************************"  --  24
  ,"             |*************************************************************"  --  25
  ,"             |*************************************************************"  --  26
  ,"             |*************************************************************"  --  27
  ,"             |*************************************************************"  --  28
  ,"             |*************************************************************"  --  29
  ,"             |*************************************************************"  --  30
  ,"             |*************************************************************"  --  31
  ,"             |*************************************************************"  --  32
  ,"             |*************************************************************"  --  33
  ,"             |*************************************************************"  --  34
  ,"             |*************************************************************"  --  35
  ,"             |*************************************************************"  --  36
  ,"           -~**************************************************************"  --  37
  ,"         -~****************************************************************"  --  38
  ,"       -~******************************************************************"  --  39
  ,"     -~********************************************************************"] --  40
sideWall 1   1  = reverseH revC . repSlash $ sideWall 1 (-1)
sideWall 1 (-1) = fromTexts '*'
  ["***************************************************************************"   --   1
  ,"***************************************************************************"   --   2
  ,"***************************************************************************"   --   3
  ,"***************************************************************************"   --   4
  ,"***************************************************************************"   --   5
  ,"*************\\*************************************************************"  --   6
  ,"*************|\\************************************************************"  --   7
  ,"*************| \\***********************************************************"  --   8
  ,"*************|  \\**********************************************************"  --   9
  ,"*************|   \\*********************************************************"  --  10
  ,"*************|    \\********************************************************"  --  11
  ,"*************|     \\*******************************************************"  --  12
  ,"*************|      \\******************************************************"  --  13
  ,"*************|       \\*****************************************************"  --  14
  ,"*************|        \\****************************************************"  --  15
  ,"*************|        |****************************************************"   --  16
  ,"*************|        |****************************************************"   --  17
  ,"*************|        |****************************************************"   --  18
  ,"*************|        |****************************************************"   --  19
  ,"*************|        |****************************************************"   --  20
  ,"*************|        |****************************************************"   --  21
  ,"*************|        |****************************************************"   --  22
  ,"*************|        |****************************************************"   --  23
  ,"*************|        |****************************************************"   --  24
  ,"*************|        |****************************************************"   --  25
  ,"*************|        |****************************************************"   --  26
  ,"*************|        |****************************************************"   --  27
  ,"*************|        |****************************************************"   --  28
  ,"*************|        |****************************************************"   --  29
  ,"*************|        |****************************************************"   --  30
  ,"*************|        |****************************************************"   --  31
  ,"*************|       -~****************************************************"   --  32
  ,"*************|     -~******************************************************"   --  33
  ,"*************|   -~********************************************************"   --  34
  ,"*************| -~**********************************************************"   --  35
  ,"*************-~************************************************************"   --  36
  ,"***************************************************************************"   --  37
  ,"***************************************************************************"   --  38
  ,"***************************************************************************"   --  39
  ,"***************************************************************************"]  --  40

sideWall _ _ = undefined

sideDoor 0   1  = reverseH revC . repSlash $ sideDoor 0 (-1)
sideDoor 0 (-1) = fromTexts '*'
  ["        \\******************************************************************"  --   1
  ,"         \\*****************************************************************"  --   2
  ,"          \\****************************************************************"  --   3
  ,"           \\***************************************************************"  --   4
  ,"            \\**************************************************************"  --   5
  ,"             \\*************************************************************"  --   6
  ,"             |*************************************************************"   --   7
  ,"             |*************************************************************"   --   8
  ,"             |*************************************************************"   --   9
  ,"             |*************************************************************"   --  10
  ,"~-_          |*************************************************************"   --  11
  ,"   ~-_       |*************************************************************"   --  12
  ,"      ~-_    |*************************************************************"   --  13
  ,"         ~-_ |*************************************************************"   --  14
  ,"           | |*************************************************************"   --  15
  ,"           | |*************************************************************"   --  16
  ,"           | |*************************************************************"   --  17
  ,"           | |*************************************************************"   --  18
  ,"           | |*************************************************************"   --  19
  ,"           | |*************************************************************"   --  20
  ,"           | |*************************************************************"   --  21
  ,"           | |*************************************************************"   --  22
  ,"           | |*************************************************************"   --  23
  ,"           | |*************************************************************"   --  24
  ,"           | |*************************************************************"   --  25
  ,"           | |*************************************************************"   --  26
  ,"           | |*************************************************************"   --  27
  ,"           | |*************************************************************"   --  28
  ,"           | |*************************************************************"   --  29
  ,"           | |*************************************************************"   --  30
  ,"           | |*************************************************************"   --  31
  ,"           | |*************************************************************"   --  32
  ,"           | |*************************************************************"   --  33
  ,"           | |*************************************************************"   --  34
  ,"           | |*************************************************************"   --  35
  ,"           | |*************************************************************"   --  36
  ,"           -~**************************************************************"   --  37
  ,"         -~****************************************************************"   --  38
  ,"       -~******************************************************************"   --  39
  ,"     -~********************************************************************"]  --  40
sideDoor 1   1  = reverseH revC . repSlash $ sideDoor 1 (-1)
sideDoor 1 (-1) = fromTexts '*'
  ["***************************************************************************"   --   1
  ,"***************************************************************************"   --   2
  ,"***************************************************************************"   --   3
  ,"***************************************************************************"   --   4
  ,"***************************************************************************"   --   5
  ,"*************\\*************************************************************"  --   6
  ,"*************|\\************************************************************"  --   7
  ,"*************| \\***********************************************************"  --   8
  ,"*************|  \\**********************************************************"  --   9
  ,"*************|   \\*********************************************************"  --  10
  ,"*************|    \\********************************************************"  --  11
  ,"*************|     \\*******************************************************"  --  12
  ,"*************|      \\******************************************************"  --  13
  ,"*************|       \\*****************************************************"  --  14
  ,"*************|        \\****************************************************"  --  15
  ,"*************|        |****************************************************"   --  16
  ,"*************| |-_    |****************************************************"   --  17
  ,"*************| |  ~-  |****************************************************"   --  18
  ,"*************| |    | |****************************************************"   --  19
  ,"*************| |    | |****************************************************"   --  20
  ,"*************| |    | |****************************************************"   --  21
  ,"*************| |    | |****************************************************"   --  22
  ,"*************| |    | |****************************************************"   --  23
  ,"*************| |    | |****************************************************"   --  24
  ,"*************| |    | |****************************************************"   --  25
  ,"*************| |    | |****************************************************"   --  26
  ,"*************| |    | |****************************************************"   --  27
  ,"*************| |    | |****************************************************"   --  28
  ,"*************| |    | |****************************************************"   --  29
  ,"*************| |    | |****************************************************"   --  30
  ,"*************| |    | |****************************************************"   --  31
  ,"*************| |    |-~****************************************************"   --  32
  ,"*************| |   -~******************************************************"   --  33
  ,"*************| | -~********************************************************"   --  34
  ,"*************| -~**********************************************************"   --  35
  ,"*************-~************************************************************"   --  36
  ,"***************************************************************************"   --  37
  ,"***************************************************************************"   --  38
  ,"***************************************************************************"   --  39
  ,"***************************************************************************"]  --  40
--  1234567890123456789012345678901234567890123456789012345678901234567890
--           1         2         3         4         5         6         7

sideDoor _ _ = undefined

upNotice :: Int    -- ^ distance of depth.
         -> Int    -- ^ distance of side.
         -> Craphic
upNotice 0 0 = fromTexts '_'
  ["______________###############################################______________"  --   1
  ,"_______________#############################################_______________"  --   2
  ,"________________###########################################________________"  --   3
  ,"_________________#########################################_________________"  --   4
  ,"__________________#######################################__________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"___________________________________________________________________________"  --   8
  ,"___________________________________________________________________________"  --   9
  ,"___________________________________________________________________________"  --  10
  ,"___________________________________________________________________________"  --  11
  ,"___________________________________________________________________________"  --  12
  ,"___________________________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"___________________________________________________________________________"  --  32
  ,"___________________________________________________________________________"  --  33
  ,"___________________________________________________________________________"  --  34
  ,"___________________________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"___________________________________________________________________________"  --  38
  ,"___________________________________________________________________________"  --  39
  ,"___________________________________________________________________________"] --  40
upNotice 0  1   = reverseH revC $ upNotice 0 (-1)
upNotice 0 (-1) = fromTexts '_'
  ["######_____________________________________________________________________"  --   1
  ,"#######____________________________________________________________________"  --   2
  ,"########___________________________________________________________________"  --   3
  ,"#########__________________________________________________________________"  --   4
  ,"##########_________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"___________________________________________________________________________"  --   8
  ,"___________________________________________________________________________"  --   9
  ,"___________________________________________________________________________"  --  10
  ,"___________________________________________________________________________"  --  11
  ,"___________________________________________________________________________"  --  12
  ,"___________________________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"___________________________________________________________________________"  --  32
  ,"___________________________________________________________________________"  --  33
  ,"___________________________________________________________________________"  --  34
  ,"___________________________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"___________________________________________________________________________"  --  38
  ,"___________________________________________________________________________"  --  39
  ,"___________________________________________________________________________"] --  40
upNotice 1 0 = fromTexts '_'
  ["___________________________________________________________________________"  --   1
  ,"___________________________________________________________________________"  --   2
  ,"___________________________________________________________________________"  --   3
  ,"___________________________________________________________________________"  --   4
  ,"___________________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"__________________#######################################__________________"  --   8
  ,"___________________#####################################___________________"  --   9
  ,"____________________###################################____________________"  --  10
  ,"_____________________#################################_____________________"  --  11
  ,"______________________###############################______________________"  --  12
  ,"_______________________#############################_______________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"___________________________________________________________________________"  --  32
  ,"___________________________________________________________________________"  --  33
  ,"___________________________________________________________________________"  --  34
  ,"___________________________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"___________________________________________________________________________"  --  38
  ,"___________________________________________________________________________"  --  39
  ,"___________________________________________________________________________"] --  40
upNotice 1   1  = reverseH revC $ upNotice 1 (-1)
upNotice 1 (-1) = fromTexts '_'
  ["___________________________________________________________________________"  --   1
  ,"___________________________________________________________________________"  --   2
  ,"___________________________________________________________________________"  --   3
  ,"___________________________________________________________________________"  --   4
  ,"___________________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"##############_____________________________________________________________"  --   8
  ,"###############____________________________________________________________"  --   9
  ,"################___________________________________________________________"  --  10
  ,"#################__________________________________________________________"  --  11
  ,"##################_________________________________________________________"  --  12
  ,"###################________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"___________________________________________________________________________"  --  32
  ,"___________________________________________________________________________"  --  33
  ,"___________________________________________________________________________"  --  34
  ,"___________________________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"___________________________________________________________________________"  --  38
  ,"___________________________________________________________________________"  --  39
  ,"___________________________________________________________________________"] --  40

upNotice _ _ = mempty

downNotice 0 0 = fromTexts '_'
  ["___________________________________________________________________________"  --   1
  ,"___________________________________________________________________________"  --   2
  ,"___________________________________________________________________________"  --   3
  ,"___________________________________________________________________________"  --   4
  ,"___________________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"___________________________________________________________________________"  --   8
  ,"___________________________________________________________________________"  --   9
  ,"___________________________________________________________________________"  --  10
  ,"___________________________________________________________________________"  --  11
  ,"___________________________________________________________________________"  --  12
  ,"___________________________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"___________________________________________________________________________"  --  32
  ,"___________________________________________________________________________"  --  33
  ,"___________________________________________________________________________"  --  34
  ,"___________________________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"_____________#################################################_____________"  --  38
  ,"___________#####################################################___________"  --  39
  ,"_________#########################################################_________"] --  40

downNotice 0   1  = reverseH revC $ downNotice 0 (-1)
downNotice 0 (-1) = fromTexts '_'
  ["___________________________________________________________________________"  --   1
  ,"___________________________________________________________________________"  --   2
  ,"___________________________________________________________________________"  --   3
  ,"___________________________________________________________________________"  --   4
  ,"___________________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"___________________________________________________________________________"  --   8
  ,"___________________________________________________________________________"  --   9
  ,"___________________________________________________________________________"  --  10
  ,"___________________________________________________________________________"  --  11
  ,"___________________________________________________________________________"  --  12
  ,"___________________________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"___________________________________________________________________________"  --  32
  ,"___________________________________________________________________________"  --  33
  ,"___________________________________________________________________________"  --  34
  ,"___________________________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"#########__________________________________________________________________"  --  38
  ,"######_____________________________________________________________________"  --  39
  ,"###________________________________________________________________________"] --  40

downNotice 1 0 = fromTexts '_'
  ["___________________________________________________________________________"  --   1
  ,"___________________________________________________________________________"  --   2
  ,"___________________________________________________________________________"  --   3
  ,"___________________________________________________________________________"  --   4
  ,"___________________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"___________________________________________________________________________"  --   8
  ,"___________________________________________________________________________"  --   9
  ,"___________________________________________________________________________"  --  10
  ,"___________________________________________________________________________"  --  11
  ,"___________________________________________________________________________"  --  12
  ,"___________________________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"_________________________#########################_________________________"  --  32
  ,"_______________________#############################_______________________"  --  33
  ,"_____________________#################################_____________________"  --  34
  ,"___________________#####################################___________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"___________________________________________________________________________"  --  38
  ,"___________________________________________________________________________"  --  39
  ,"___________________________________________________________________________"] --  40

downNotice 1   1  = reverseH revC $ downNotice 1 (-1)
downNotice 1 (-1) = fromTexts '_'
  ["___________________________________________________________________________"  --   1
  ,"___________________________________________________________________________"  --   2
  ,"___________________________________________________________________________"  --   3
  ,"___________________________________________________________________________"  --   4
  ,"___________________________________________________________________________"  --   5
  ,"___________________________________________________________________________"  --   6
  ,"___________________________________________________________________________"  --   7
  ,"___________________________________________________________________________"  --   8
  ,"___________________________________________________________________________"  --   9
  ,"___________________________________________________________________________"  --  10
  ,"___________________________________________________________________________"  --  11
  ,"___________________________________________________________________________"  --  12
  ,"___________________________________________________________________________"  --  13
  ,"___________________________________________________________________________"  --  14
  ,"___________________________________________________________________________"  --  15
  ,"___________________________________________________________________________"  --  16
  ,"___________________________________________________________________________"  --  17
  ,"___________________________________________________________________________"  --  18
  ,"___________________________________________________________________________"  --  19
  ,"___________________________________________________________________________"  --  20
  ,"___________________________________________________________________________"  --  21
  ,"___________________________________________________________________________"  --  22
  ,"___________________________________________________________________________"  --  23
  ,"___________________________________________________________________________"  --  24
  ,"___________________________________________________________________________"  --  25
  ,"___________________________________________________________________________"  --  26
  ,"___________________________________________________________________________"  --  27
  ,"___________________________________________________________________________"  --  28
  ,"___________________________________________________________________________"  --  29
  ,"___________________________________________________________________________"  --  30
  ,"___________________________________________________________________________"  --  31
  ,"#####################______________________________________________________"  --  32
  ,"###################________________________________________________________"  --  33
  ,"#################__________________________________________________________"  --  34
  ,"###############____________________________________________________________"  --  35
  ,"___________________________________________________________________________"  --  36
  ,"___________________________________________________________________________"  --  37
  ,"___________________________________________________________________________"  --  38
  ,"___________________________________________________________________________"  --  39
  ,"___________________________________________________________________________"] --  40


downNotice _ _ = mempty

{-
frontWall 0 0 = fromTexts '*'
  ["        \                                                                  "  -- 1
  ,"         \                                                                 "  -- 2
  ,"          \                                                                "  -- 3 
  ,"           \                                                               "  -- 4 
  ,"            \                                                              "  -- 5 
  ,"             \                                                             "  -- 6 
  ,"             |\                                                ____________"  -- 7 
  ,"             | \                                            / |            "  -- 8 
  ,"             |  \                                          /  |            "  -- 9 
  ,"             |   \                                        /   |            "  -- 10 
  ,"~-_          |    \                                      /    |            "  -- 11 
  ,"   ~-_       |     \                                    /     |            "  -- 12 
  ,"      ~-_    |      \                                  /      |            "  -- 13 
  ,"         ~-_ |       \                                /       |            "  -- 14 
  ,"           | |        \                              /        |            "  -- 15 
  ,"           | |        |\                             |        |            "  -- 16 
  ,"           | | |-_    | \                            |        |            "  -- 17 
  ,"           | | |  ~-  |  \                           |        |            "  -- 18 
  ,"           | | |    | |   \                          |        |            "  -- 19 
  ,"           | | |    | |    \                     ____|        |            "  -- 20 
  ,"           | | |    | ||-_ |\                  /|    |        |            "  -- 21 
  ,"           | | |    | ||  || \                / |    |        |            "  -- 22 
  ,"           | | |    | ||  ||  \              /  |    |        |            "  -- 23 
  ,"           | | |    | ||  ||-_|\            /|  |    |        |            "  -- 24 
  ,"           | | |    | ||  ||||| \          / |  |    |        |            "  -- 25 
  ,"           | | |    | ||  ||||| |          | |  |    |        |            "  -- 26 
  ,"           | | |    | ||  |||||_-          -_|  |    |        |            "  -- 27 
  ,"           | | |    | ||  |||_~              ~_ |    |        |            "  -- 28 
  ,"           | | |    | ||  |-~                  ~-____|        |            "  -- 29 
  ,"           | | |    | || -~                          |        |            "  -- 30 
  ,"           | | |    | |-~                            |        |            "  -- 31 
  ,"           | | |    |-~                              ~-       |            "  -- 32 
  ,"           | | |   -~                                  ~-     |            "  -- 33 
  ,"           | | | -~                                      ~-   |            "  -- 34 
  ,"           | | -~                                          ~- |            "  -- 35 
  ,"           | -~                                              ~-____________"  -- 36 
  ,"           -~                                                              "  -- 37 
  ,"         -~                                                                "  -- 38 
  ,"       -~                                                                  "  -- 39 
  ,"     -~                                                                    "] -- 40 
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7
-}

werdna :: Craphic
werdna = fromTexts ' '
  ["                                                                           "   --    1
  ,"                                                                           "   --    2
  ,"                                                                           "   --    3
  ,"                                                                           "   --    4
  ,"                                                                           "   --    5
  ,"                                                                           "   --    6
  ,"                                                                           "   --    7
  ,"                                                                           "   --    8
  ,"                                                                           "   --    9
  ,"                                                                           "   --   10
  ,"                                                                           "   --   11
  ,"                                                                           "   --   12
  ,"                                                                           "   --   13
  ,"                                       .8H[                                "   --   14
  ,"                                      .HKON-  .m,                          "   --   15
  ,"                                     . HHkK` .dNg,                         "   --   16
  ,"                          WUHX+...  jNNMQQWNNLdMM]  ...J++,                "   --   17
  ,"                               dM8dHNMdMHmdHuHMBkMM9^?!   ?`               "   --   18
  ,"                              (NgdkMMW#dC>dYMMMNQMb                        "   --   19
  ,"                          ..gHMMMSdkNKVw<(+4dMMMNNHMHWH,                   "   --   20
  ,"                       .&HHMHHHMNMMMMK1W$~j+NHMMMHMMMMMM|                  "   --   21
  ,"                      .MMMHNMMMMMMMHMSljD<_vHWMMMMMMMMMMN,                 "   --   22
  ,"                   JHgWMMMHMMMMMMMMMMh+Wl~(WJHMMMMMMM#Cd#!                 "   --   23
  ,"                   4HMMHMHMMMMMNMMMNH5dXb(<UWHMM^!    T#`                  "   --   24
  ,"                   dHHHNHMMHMMMMMNMMSRzZPI~(dNM~                           "   --   25
  ,"                  (F`  7^=7T^1dNMMMNWNOP$<~+gMM]                           "   --   26
  ,"                .MY        .dMMMMMMNM#dR1>((WHM]                           "   --   27
  ,"               .MP        .8JHMMM#MMMHMNk>(<1dNK+                          "   --   28
  ,"               (MR        JndmMMMMMMbMMMMz(l_dNWd~                         "   --   29
  ,"                ?Hn.,  . .HHHqHMMN#MNKHMMwJRwWMBf                          "   --   30
  ,"                 (H;   .~JFOgHNMMMMM#qMMEdH6dMMM%                          "   --   31
  ,"                  .74JT^ (;(HMMMMMHMHWHQHMBdMMM]                           "   --   32
  ,"                          ?(HHMMM#HM@@MMMNdMNMM]                           "   --   33
  ,"                             ?4MNNHHMHqMNMMHMHM]                           "   --   34
  ,"                          .   .BYHHMHYGiMMMMMHM]                           "   --   35
  ,"                          h, .HNMNHMMMMMMqMMMgM+....                       "   --   36
  ,"                      +JNMMNmgMMNMHMNHMMqkMqMNMMMMMY^                      "   --   37
  ,"                           .??????^^WHMMNNMNMHB^=!                         "   --   38
  ,"                                                                           "   --   39
  ,"                                                                           "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7

himiko :: Craphic
himiko = fromTexts ' '
  ["                                                                           "   --   1
  ,"                                                                           "   --   2
  ,"                                                                           "   --   3
  ,"                                                                           "   --   4
  ,"                                                                           "   --   5
  ,"                                                                           "   --   6
  ,"                                                                           "   --   7
  ,"                                                                           "   --   8
  ,"                                                                           "   --   9
  ,"                                                                           "   --   10
  ,"                                                                           "   --   11
  ,"                                                                           "   --   12
  ,"                                 .                                         "   --   13
  ,"                                .(+&.                                      "   --   14
  ,"                                (MMdW%                                     "   --   15
  ,"                                .1Q9s(.                                    "   --   16
  ,"                                .(T9>_<<(.                                 "   --   17
  ,"                                .(+gIj(JTXo.                               "   --   18
  ,"                 .T~....      .8jWQdoZMMN/1+-                              "   --   19
  ,"                  _    1&(_(-,TzdsRkzdMMMN.~                               "   --   20
  ,"                  :      /'?NKRcagJv<T9dMMN.                               "   --   21
  ,"                  :     .[ (Xb#tdMNE0NHj~w/<... ``  `                      "   --   22
  ,"                        .b..d6#%?MMCdMWw/7'J) `  _4C                       "   --   23
  ,"                        ,#~.d(@{(X+(0N#dx .(R.         `                   "   --   24
  ,"                        .M(_J<NrJXdZ0MHJb< ~dh                             "   --   25
  ,"                        dM[!v NCd0dbcMM|N+<(?@N                            "   --   26
  ,"                        ,MN.\\ NlXOdb$MMb,Nx<<d#!                          "   --   27
  ,"                         (9! `NlKVdbIMMN; 7h<J`                            "   --   28
  ,"                             H#lHkX@OdMM@m,.\"=                            "   --   29
  ,"                            .M#3MZXH?dMMNMb                                "   --   30
  ,"                           `.M#CMXwM(dNMNHg.                               "   --   31
  ,"                            JM#CMmkN(cMMMMHL                               "   --   32
  ,"                            WM#1HNMN;zHNMNHH,                              "   --   33
  ,"                           .@M@lMNMNL1?NNMNMh                              "   --   34
  ,"                           .@M@}MNMMW,IdM#MHMh                             "   --   35
  ,"                           dNN9:dMMMNb(IMMMMMMh.                           "   --   36
  ,"                        ` dNM5! MMMMNM,(1WMMHMMNm..`   `                   "   --   37
  ,"                          `!`   ?T\"\"\"\"^  .?THMHT\"!                    "   --   38
  ,"                                                                           "   --   39
  ,"                                                                           "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7



city :: Craphic
city = fromTexts ' '
  ["HMHk,d$_.     `` ::::_~_ ~::::::~:~~~~~..`   .  ``                                    `  `"   --    1
  ,"MNHMkkI-``     __~::~_   __:~~~~~~~~~._...                                         ` `   `"   --    2
  ,"lvMNWHCXk-...   ` ~~_ .  ..~~~~~~...._......    `     `                           ` ``    "   --    3
  ,"zlldMMMmWkXHHn.   __        `__......````  ````      ` ````                              `"   --    4
  ,"zz==zTMkNXWkUMkn, `..     `    `.. .`.   ````` `     `     `   `  `  `  `  `  `         ` "   --    5
  ,"zz1z==1TNHmUNHHNkU&.         `  `              ``                             ..  `  `   ."   --    6
  ,"Nc1=?1??1TMMHMmZWNgU&.          `                 `        `             ` ._``  ` -..~~_."   --    7
  ,"vTnvzl?1z+?WMNVS?YKWWczmn.XC```                                      `  `` ...`  -_~~~_  ."   --    8
  ,"NgwzOz1++?+>?WMsdNJWqdUd?T4>`    `                  `         `  `  ``` ``.`..__~:;:~__   "   --    9
  ,"NMMMNmzzz+???<?WNdNZTHHZUGwXy,``          `            `  `           ``.  .....~~:~~~____"   --   10
  ,"NHMMMMMMNszvz>><?HHHmlr1TGJ<74A(.   ` `    `` ` `            `  ` ``  ..   .~~__~__:::<~` "   --   11
  ,"MHMN<(HdHMMMNmaJIv7TWHr(_ <(+(?Ww-.` ````      _  `  ``    `  ``      ..   ..~_   .``.__~~"   --   12
  ,"MHMM~-Sd$WM.._?HMMHmazz-(-.JdG_wz(wC_  `` `` .--..  .. `        ```    _.``..___ ``  -_.._"   --   13
  ,"VTUHkJkdmW#.._ wJM!(VVHHm&+v4WdXww+z+-._.   .1<<-__JO1. .   ```   ```  ``. . .`.`.__~~...`"   --   14
  ,"XjVJdjRdVTURa+.kJM`(XOXI_(?UHAZVXku+1+Tz.. (<<<<<jJv<(1i.`  _    `..........~~~~~~~~(__```"   --   15
  ,"KU0dhJRXI==dzdzXVU6dGzXl >..:_(USdvv++<<-?1<X(-+<II++__?zi(O1+<<(~   ....___....`` .WWHWkQ"   --   16
  ,"HHkHWWSXRUWVSWdAkd10??R(jO-.}- z0d1<?<vIaJ+-.(II1zo(+zwZtwXX>+(.(Gu_``.-...&dp3.` .WWWWWWk"   --   17
  ,"F(MNJHZXdZO7TkHkXAAXVOk-u1<(1zzInCz1vv+JdZI<zC<7WWyz+vOVOwVUo+wI(oJo(jOzUmJ+OU+. .VWkHbbHH"   --   18
  ,"bdM#(WId9H0`.#(HHdM`.Z0_??7OwGnc(+???<<??6l<?(vOCXWWAxJ<~(<<+;+<<dyOUwvSyvHHHH8WWVfWWWWbHH"   --   19
  ,"bdMNjdkdIdr..MdMHdH ,OI_ - ( _`(dd-(<_?<zzl(<(<vj0??7TTXfzk?:~<(<v0OdXXWX0XZSXXyXXXWXHkWHg"   --   20
  ,"YT#HyJRd0VWU#W9XHUWJJun/.; . _ (?vC?0><jlc>(_-<<jI+>((<+?1v1+-((jkXXXWqWWWWXXWWXHHkWqHggHH"   --   21
  ,"hWuMbg#?OwdRKuHyXOddzz$(J1vrC1>>_._.._:11z>(-(i+JD=711ju+(A-<<<jWWKXWXWHWkHNHHWHHMHHmHH@NH"   --   22
  ,"MMMMWgMHHWHHMHHHWkWfYTHk+<<<<<<?:++.._(JI+><<??<dfI$++1J76VC<++jkV\"\"\"7THHHMMMNWNNHMHHHNMMH"   --   23
  ,"99VOTUWX<<MQkc(gmozJkD~jkknJ.(J-_dv=(r?zzku(>.(>dCC0CXQd>Xm<ukHuWIXbNddkdW#HHXJMHHMMMdMHMM"   --   24
  ,"MMMMHNHXdG&dK0MMHRzdbR:(MMMNr-gk_vz. (jXzZd??jJ<dAOXwHHWIWMz1wUkJoaAzkddwwvM9M#WNMMMMH#MMN"   --   25
  ,"HXMNHMHWdXHd#kNM#HvzH0_(HMNNl-HbTUI+JO&4MtJOz(6<?WykwC7Oms.(jwwdyXWU0WddWXWHHNMHMH#HMMMMMM"   --   26
  ,"NWMM@M#NNTMHdbyMMEwwkZl(HMMMM5++(SXvWOy1C0OIJMHR/Xhgs-_?XHjgHNMMMMMMMHMMNH9VUHMMMMMHHWgqmq"   --   27
  ,"MHMMMNNNHHHMHWHHWWmsXyyzWDTM8<X+XWX-P<r`(HzA.(T9!d&WMh(AHWMMMMMMMMMMMkWNuNmg+WppppbkbHqqqq"   --   28
  ,"NNMNHHMNMMHNHHHHWW#UVY\"!(% .jAdzXs1++n-<J@I(<v<<+JdWHXXmgHfVWW0WHHBUQmNNgNNMmAXWbbkkbkkkqk"   --   29
  ,"MMHWBHkXMHH9YTVO<jP<<~_.(L(&JVM9MMNNmZq2V8XWkXW0VwIdWkwUwXuXZVzOZ=!`_7>jMMMWWpWXXUVUWkHkHq"   --   30
  ,"UWkv+1<_Hi-(_(i(_(hJzY\"1j@I7iJW?3udMMR(&dUUXUOAQnxzdHWwkVXOwIz?~~ -.~++XVXIwUUUUOOwUXWUUWH"   --   31
  ,"                                                                                          "   --   32
  ,"                                                                                          "   --   33
  ,"                                                                                          "   --   34
  ,"                                                                                          "   --   35
  ,"                                                                                          "   --   36
  ,"                                                                                          "   --   37
  ,"                                                                                          "   --   38
  ,"                                                                                          "   --   39
  ,"                                                                                          "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7
--

city2 :: Craphic
city2 = fromTexts ' '
  ["O_.?                                                                              =?????dHWWWlt"   --    1
  ,"Z..(:~                                                                            (????dMMSzSwd"   --    2
  ,"3..(x:                .(,                                                         .????XMXRddH9"   --    3
  ,"..._1;                ~(>                                                         _~~+dM@XWqSWZ"   --    4
  ,"o_..(c              ;jK$v<:                                               (ROwwwrrvrrwWMXWkq0WH"   --    5
  ,"_1i__1              +dHYTz&                                               JHywuzXzzzudM#tXWH9Wr"   --    6
  ,"<._1+(+++?++++<      Xk>+J(<                                           ...dMHZzuzuuXXHMXdX9krdr"   --    7
  ,">x-.(zz====l====?+   XH>dR_~                                        ((((((NWHWrzzzuzXMNX0drXzdX"   --    8
  ,"><j:.(z1z1==v<<~~?   XH>?C((                                       ~drOrrd#WWHROwwXwHMSO0dwdHgH"   --    9
  ,"z+j~`-Z===+_:~-  . ` Xy>+1<.                                       (HZrrrdMMMHWwOrwX#8kdAWHHHkt"   --   10
  ,"?(l_.(Xy====z&_~_-...zu>~(_`                                  ;<j++gNRrrwWHWOWXkZOdM#AXmHHW0HKw"   --   11
  ,".._~.(uXy=???zW+::_~_uX>:((`                                  __dz=dM#tOwMKXwWuWXyW#MHHWkMSybKr"   --   12
  ,".....(ZuXc=??=?Uy+;:_XXC<+(`                                  ~(HI=WW9wwdNKWHHWmHMHMHHudWHkwkRd"   --   13
  ,".....(WWZUx=????Zk=+;XU><<(...._                          ;zzOOdNdd#wXHMM#WWWHHkXHMWWHXdqHWXHkW"   --   14
  ,"-_..-(uuZZXx?=1??vWz?Zu>~(~_~Ju+                          <zCttWSkWNHHVXdHWHXRdKdHNdWHudH@MMHwS"   --   15
  ,"<6i-.duZZZZWz??dmx14eXX&us-_(yuz<:;                       jwVzw#WXWSXHVdMHXKXKdHXWNIXqHHXXdKWXQ"   --   16
  ,"<<+<.dZZXZZuWsz?zWHkdHXuuI.?dHWW6<;;;                    :wXZ1d9wwUwU9GWHWdHdWyXQMMkWdSkWXXWHHH"   --   17
  ,"v1+~~qmmmmmQQQkyz?dOvHkXZI`.uZXZZZZZX<<                  (zzGOHUw0kGgHHSHHZQdHHWWHMM@QkgHgqHHHM"   --   18
  ,"<?1<~XHHHHHUUC?9WkAxz?UdWI..vrwXZZZZ0wk~~                (wzrj#udwXXWWWkHHHWyXWHXHM6WgHHHMHkXKk"   --   19
  ,".~..~XWXVOlzO>(~.._7WkAzWR.,UBYYSZZZCXWJ/                jwuXdRUZwwXUVIzHkXHXKXHwpqVWHWWH#zWHNk"   --   20
  ,"~.~._WVXyllOrI(_+_`.(_-?4X&.11><jZZZ<d0XI:             (_wZuXMAXUwwQAgWHWpXHdKdHdWHUWNwdHNwWkNV"   --   21
  ,"-.~~~<<zC1zOOz(_+_`.+_``< (7TXA;(ZZk:j6k2~            :dOKXXUudXRKWXXHHHXbXHWyyyyXHzXH0JH#UXkNI"   --   22
  ,"I-..~_~~__<~~(d__`.+.```+_-.-z-!?XH3~(+XI~  ~($(XzzzwvwwIUXwXXXWSSUVdNM8XyyUWUUXVWHOdHZdHNOdHMn"   --   23
  ,"U0I~~_~___~~_zd_...l_.`.j>(.<u(~>W#zXW7dI:  :JwdHrwOzzdzkzXZZzrtrrrrduWkwVfXffffVWKOdHHkHHUHMMN"   --   24
  ,"wZz~~~.~~~_~(rd<?_(O2...zo(`(l>`_Z0j_>&<+yXXXWXHHkkwXOWWWU0UXurwwwyrHuUSyf0VwCdkXWKOVMMMZXWMNMH"   --   25
  ,"wwz_~~~~~~~(Wydl>_zd$..(OR<.tXo.-WHdXR?$WXVWHbWWWkHkwzdZSjyWWWkWWMNwwHHMXHk<w>dWfWHXwWWZZZZMMNW"   --   26
  ,"wkz~~~<~~_~(fkdO<(tdw-.IrHI.tZC.-VSZnk((XppWWkHWHkWWdwXZ0=WWWWHH998UuZXWkkkkXmdWWWUZZwzZXWHWHNH"   --   27
  ,"<?<~(+OtwwIzpkdwx(zdko-zvZO-OOwo.dWXWXwSuwkZW9WWHHHQkHWH9AQkQKUUXzMMHHHMH@@@@HHHWkWWkWqHWHMHM@@"   --   28
  ,"(JX0XKSCQdkAOWdZt<rwWHHUUVvWNMNpHHHyWXdwkXHHWWW8HWHMHkddWAkkkmJzvCTMHWWWfbHHHfppbHNHMMMMMMMMHH@"   --   29
  ,"M0UUWHWXXWNQQkHmmnwkOOOv(_,(MNMHHHWWyXXyVfffffffpfpppWMMNNMHwdgZzdM@kzOwwXXWXWWWWWMMMMHMMHHMHHH"   --   30
  ,"                                                                                               "   --   31
  ,"                                                                                               "   --   32
  ,"                                                                                               "   --   33
  ,"                                                                                               "   --   34
  ,"                                                                                               "   --   35
  ,"                                                                                               "   --   36
  ,"                                                                                               "   --   37
  ,"                                                                                               "   --   38
  ,"                                                                                               "   --   39
  ,"                                                                                               "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7
--

tarvern :: Craphic
tarvern = fromTexts ' '
  ["+?;:_~<?1zHWNWb                             ~~:::::;>:;;;<?z>1z?+?=zzz=lOtzvOtrr"   --    1
  ,"z1<<~<(judS+zZ0                            (:<(;:;;;<:;;<+=z>11???=zz?zlllzzZltt"   --    2
  ,"<+<<~~~_(j(-..~                  +         +>>>?><<<z+>>?+=z?zO???zlz?O=OlzvIllt"   --    3
  ,"++<:<<<(iXWWpS_  .              _+       ??=?1z=>?z+z<???1l??z=z?z=tl==zZ=OrZllO"   --    4
  ,"=+;;<(+twkWXpI+-..              .z?===zzl==zzl?l??z+z>?==zOz?zl=??=tl?=lO=OzOllz"   --    5
  ,"1+;<:<1zdHWpWI+-_~              _z1lllzwrllwItzl1z=+I?===zOz+zOl===tl===llwzIlvz"   --    6
  ,"++<<<;zOw0OrwzZ-_~~~_~~~~-_~~_~-(OzrrtwzvIOwZrOl===zw====zOz=ztt=?zrl=lll=wwIlzw"   --    7
  ,"WWUUUUUUUUUUUWgH<~<<_~_____<_~~(<wOzwrwuuOwwwXtw=lzzax1llzOI=ztt==zwl=zOt=wZOl=w"   --    8
  ,"IlOwvOOOOwrwZd@@I<:<<(<___(<:::<<wwuXwXXuZwwwXOOllzdHWztOwwI=Otr=zzrO==lr=OOtl=w"   --    9
  ,"vwwwZOzzzzzzldMHn++z+jHHkHHc::(z+ZXyXXXyZwuwXutrzltdHHzrtwXIlOtvllzXwz=ttlwOrt=w"   --   10
  ,"yrOwwwwOXXvOOdHO1=llOHMMMHHN+<<zluXXXwXXXZXXzZwwz<1dWDRwtwXIlrOullOkvz=rrlrOttlw"   --   11
  ,"zuzzzrwvZC(+dWKzwZzrwXHHHMMSz+1ZzyZVWXfyZuXuXwwOjJuHWXRXOwuZwkwullwwvzlOrtttttlX"   --   12
  ,"ww&AAAgQQQQkWWDOwVXVwdmHHHg01zzwzVyVWWpfWuuuzzZtdbdWKdk0OOVZtrwullvwvvzOwtOzXOOX"   --   13
  ,"MMMM@@@ggHHHWWKUOwUMMMMMNMMMWB=77TC1zOOOrOtOOO3zdbdNX#wwwwzuXwzwz=wXwzzwwtOtzwwZ"   --   14
  ,"NNNMMMMH@MMkWWSwXXWM#HWMMHaJJ---(+<1+;<;;<+11?zzXHMNMHXwwwwwXwZ0XXZuwwwwwwwwzvwX"   --   15
  ,"NN#MMHHHHMMMHHWWHHM#NXXMMkSdH#MHHMMMMHMMMMMMMMHHHH@HHHWwwwuzuwwzXOdSrXXXZyZZXwwX"   --   16
  ,"MMHMM#HMMHMMMMMMMMMMNNNNMN#HNNNHWkgNMMMMMMNkWfWWWH@HHHHXwwZuuwZzwZztvOzwrwuXUUZZ"   --   17
  ,"MHgM#HHMMM#HHH@HMHMNNNNMNNM#N#HNWqMMmqMMNkbMHppWpHHMMHHXZXZZZXZ0wZvOzwzwzruwzzrt"   --   18
  ,"@@gHHHMM#MMHMM@MHMM@@gggM@g@@@MggMNHHWMM#UUT9TTC7z11><11-((++++((-((?+1zwwXvzrvr"   --   19
  ,"@@@HHMHHMMHMNpbHWMMHHHpWWHHkHHqHqHNHKCC<<;;;;>>>??>+<1111zzzz=llllOOIzwwrrrwzzuz"   --   20
  ,"MH@MH@MHMMMMH@MMMMNWyyXZZXWWWWfWpHN@o:<;;<<>>>??????>+zlll?==ztltrvzvrrwOOltrrvz"   --   21
  ,"HHHMH@MH#MHHWmHgH@HUuXXzvvzXXXUWWWM@Mme+<_(+??????11??1==lz1zzz1zzrwztOOttzOttrz"   --   22
  ,"MHHHHMNHMMM#M@@HHMWuvrrOtttrrrvuXMMHUHMMNmge&++;>>>>>>??????????=<<<<<<<<~~_~~(1"   --   23
  ,"MMMMH@HMMMMMMNNNNNuwtllOllltOwQkMHMMMNHHMMMMMMNNmmmQAwzzOzzzttlltz-(++z&-_~~~~~:"   --   24
  ,"HHHkW@M@MNNMH#MMMHuOll=z=11udHBWUZXWWW#bHWHWHmmHMMMMMMM#MMNNNHHQQQQmmQQQQQmmmQQQ"   --   25
  ,"HHggg@MMMMMMMMMHMHuOl=??1?dMIOOvuuXHWMNHHMHHHMH@MMMMMMMMMH#MMHHMMMMMMMMMMMMMMMMM"   --   26
  ,"NNMMMNNM@MHHmHHyyZwO=??>+>j#TWQmmwXNHMHbHMgHHM@MM@@HHHHHMMMNNMMNMMNMNNmkbkpkkkbm"   --   27
  ,"MMMHMMMMHgqkppfWyXwOz??>>zj#=zwrrXXMMMMMHM@mHMH@MMHHfpffWMMMHMMMMMMNWWMMNHbHqHkM"   --   28
  ,"HM@gHHWggqkkpffXuwttl???>+J#?lOwuZXpMM@MHMHHMMMHVpkkbbkWMMkWHMMMMMNNHWkqMMNggHqm"   --   29
  ,"HHMHHpH@qHbbWHWWyXwtllz===d#llOvXZWpHMMMMNkWyWWHHHHHHHMMHgggMMHNMMNMNHHHHMMMgggg"   --   30
  ,"MMMHHHH@HHmHkHpWWuuwttOz=?zHzzzXUyWWWNHMNWHMMMHMg@HHHMNNNMNNMMNMMMNMMHH#MMMM@gg@"   --   31
  ,"                                                                                "   --   32
  ,"                                                                                "   --   33
  ,"                                                                                "   --   34
  ,"                                                                                "   --   35
  ,"                                                                                "   --   36
  ,"                                                                                "   --   37
  ,"                                                                                "   --   38
  ,"                                                                                "   --   39
  ,"                                                                                "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7
--

edgeOfTown :: Craphic
edgeOfTown = fromTexts ' '
  ["MMNNMM##MMHMN2~.                                    ~<-&.                 _:~~~<"   --    1
  ,"NNMNM####MHHMHmdHR!                                 (WjZZX..               .`` ."   --    2
  ,"MNMNNNNMHHMHHMHXY3_                               _JV$wXXZZk,         ____~~~~~~"   --    3
  ,"MNNMNNNNNNMMHMMMHp...                            .XWfjXXXZZXXk,_. _-~~~~:~_.__~~"   --    4
  ,"NMNMNNNNNNN#HMHHHk;.~                           .yQmWWkkQkkkXXXG,~~.~~~~~_~~::(:"   --    5
  ,"MNNMNMNNNM#M##HMMMM2~_                        _JWHHW0XuXuXwzXUUV9WkaJ~__:;;;;<;>"   --    6
  ,"MNMNNNN#MMM#MHHMMMM><:                      -(dHVWZX><?+771myzOrrwO<::_:(<?+<+<?"   --    7
  ,"MMMNNNNM###M#HHHf=                         (XWXZXWZ0<_~~:~(M$-__~~.(<<<<<~(J-<<<"   --    8
  ,"NMNNMMMN###HHM#T\\                         <~(ZXSuUZC<~~:~~~___:~_~_(<1jJZTz==+(<"   --    9
  ,"NNMNNMNNN#MM##HNs~                         _(XXuVC=z<_~_~:_<~~~:~(JZC<<<<++1=z1z"   --   10
  ,"MMMMNNNMMNM#HMHB3_                         _(VC?????<~~_~__~~~~::::;+<+??<><>>zl"   --   11
  ,"NMMMMMMMMMMN?T<                         >+wOz???1?z1<.(~_~~:~~~~<_;<>>+><>1<1?+="   --   12
  ,"NNNMNNNNNM#H8<                 uAdXXwz??zOwXy+??z?1z<__~__.~~~_~:~<<>>?>?<++?+?1"   --   13
  ,"NMNMMNMNMMMHN?               dWWbWWHkkOOZXXbR>?>?<>1<~~_~(.____~~~;;>?><><><<1?z"   --   14
  ,"MNMMMMMNMMMmzl             twXpHWgHHHSz11OUHD?<<?<<+<____.__~.~_~_:;;;><<?+<<<><"   --   15
  ,"MHMMMMNM#HNOtt           =zdXWHHHHHbkHI(XSdW0<><<<+1<__~_~~~__~~__::;<>+<<<+><<;"   --   16
  ,"MMMNNMMN#MHVOC       <1v?1+zXHHWwZzdXZdZZWyZ0>>>??+=>_____~~-~_~(_~(:;;;;;;>>>1+"   --   17
  ,"MM#H#MNNMM3(;      dWWWWkZXSWHHUUZOtwwwZXZyW0+++<>?1<.__~~~~__~__~_:<;;v;;;><>>?"   --   18
  ,"MMMNMMMN1?1zz1uJHWWXwXyywzOOUUSVOzzzwwwXuwXXI<>;<>++<__-~._~-~~.(~<:<++><>><<+??"   --   19
  ,"HMMMMmxzgdvCUXVXIO0OzwXrr<1zOOI1<>>zwOtwXX0OC<><<?1+<--~__<__.(_~_(<<<;?<>;>>+?+"   --   20
  ,"MNMMMMSOWS><OOv?I1Zz+zzI<:<<+O?<+++lOzdWmHdvz++<+<1zC______~~~_ ~_._---~-.____-."   --   21
  ,"HMMMMMMWkR-((<:jz=+<<1Xkc+&zzOZ<jzdWKwWMMMWHR>><><??<-__.~~__~~~_______-___~___-"   --   22
  ,"HMMMNMMHagZCOuSyzuz<><dZjIXWuZ1+vVC4WwdMHWHH#<<;+>+?<_.~_~__~__:_(~__~~_.___~:_-"   --   23
  ,"NHNNMHQkWHHM@mJv7=<:~(wwXwWWfW&vddsZwwX8OdHHk<<><><<>__~~._(-- -..._-.._____.___"   --   24
  ,"N#N#HHMHHHMHkWWHHpmx-.~?77\"Tv7(WWSrOWXwOwHHWD<><>>>1<.-~~_~~<!_...-_ __._.--._._"   --   25
  ,"NN#NNN#MMMHMMHNHWVyZyk>`  `_._~!~~1w0wkXVKXky(<<<?><<..~~_(_-_-.._..`~.__-(2___~"   --   26
  ,"MNNNN####HHHHMHMHbWWkk>_       ~_<-(?wWHkWHW$>><<<;<<_.~____.._(<<__~__~___<___~"   --   27
  ,"NNNNNNNNN###HHHHHHMHHkH&+_____~_<i1+++1OZXWXS;><>;>><.~.._....__.____._________~"   --   28
  ,"MMNNMNN##MH###H#HH#HHHHbkHkae++dkyWXWXWkHHH0D<>>;><<<....._..._.______._._~____~"   --   29
  ,"NNMNNNNNNN###HMNMM#H##HMHkpHXXkbkHWWWWWWWH8C!_<<J<>><-..`_..-_. ~.._..._...._-~~"   --   30
  ,"MMNMMNNNNNNN#MMMHMMMMMMgMMHWWWWWWHbHHWHkRyr.  ..<_!<<_._-_.._....__..__....____~"   --   31
  ,"                                                                                "   --   32
  ,"                                                                                "   --   33
  ,"                                                                                "   --   34
  ,"                                                                                "   --   35
  ,"                                                                                "   --   36
  ,"                                                                                "   --   37
  ,"                                                                                "   --   38
  ,"                                                                                "   --   39
  ,"                                                                                "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7
--



treasureChest :: Craphic
treasureChest = fromTexts ' '
  ["                                                                           "   --   1
  ,"                                                                           "   --   2
  ,"                                                                           "   --   3
  ,"                                                                           "   --   4
  ,"                                                                           "   --   5
  ,"                                                                           "   --   6
  ,"                                                                           "   --   7
  ,"                                                                           "   --   8
  ,"                                                                           "   --   9
  ,"                                                                           "   --   10
  ,"                                                                           "   --   11
  ,"                                                                           "   --   12
  ,"                                                                           "   --   13
  ,"                                                                           "   --   14
  ,"                                                                           "   --   15
  ,"                                                                           "   --   16
  ,"                                                                           "   --   17
  ,"                                                                           "   --   18
  ,"                                                                           "   --   19
  ,"                                                                           "   --   20
  ,"                                                                           "   --   21
  ,"                                            HmxvT                          "   --   22
  ,"                                MM@MHHbkk+?4bbWHh_7                        "   --   23
  ,"                    MNggK7TH@@Hm+JWHWfWpfWW,,yWWWW,d                       "   --   24
  ,"                  NNN#HHHHa-?pHWfhYdkfWWfWWW2dpWWpb_                       "   --   25
  ,"                  #H#MHHHHMN,,WfWpk1dHHppWpbN-jkWkM~,                      "   --   26
  ,"                 MMHH#H@HHH@N??pbHq[-WHNAJjZ9-,1uggl(                      "   --   27
  ,"                 M#MMMkMMMMM#[.WH9Y9..JdW3JWM-(HHpbr-                      "   --   28
  ,"                 MHMMHHN#MNNH8?1QggH_(HMNW+WH<WWkWW$(                      "   --   29
  ,"                 #MHMMMMMM##MH+jkWbW:(MHWHWWH_ZHHHW]-                      "   --   30
  ,"                 #HHMMNNMMM#MMHdKHpW<(HbWVVWHdwHNkWHM                      "   --   31
  ,"                 #H#MHMMHHHHHXjdWWWHe(HkfWHWH0xMMHHSd                      "   --   32
  ,"                 M#H#HMHMH@@@VWdQHkHzWNHpWHMM(RSm2C~J                      "   --   33
  ,"                   ##M@MMM@@M0HdMNHHjXHBkg?7>((NggggggH                    "   --   34
  ,"                     NKMMMMMM0HdMMkd9RQQ.gN      NNNN                      "   --   35
  ,"                        NNMHM#WHdmg  gggg                                  "   --   36
  ,"                          Ngggggggggggggmgm                                "   --   37
  ,"                               NNgggggHHggggg                              "   --   38
  ,"                                                                           "   --   39
  ,"                                                                           "]  --   40
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7


treasure :: Craphic
treasure = fromTexts ' '
  ["                                                                           "   --   1
  ,"                                                                           "   --   2
  ,"                                                                           "   --   3
  ,"                                                                           "   --   4
  ,"                                                                           "   --   5
  ,"                                                                           "   --   6
  ,"                                                                           "   --   7
  ,"                                                                           "   --   8
  ,"                                                                           "   --   9
  ,"                                                                           "   --   10
  ,"                                                                           "   --   11
  ,"                                                                           "   --   12
  ,"                                                                           "   --   13
  ,"                                                                           "   --   14
  ,"                                                                           "   --   15
  ,"                                                                           "   --   16
  ,"                                                                           "   --   17
  ,"                                                                           "   --   18
  ,"                                                                           "   --   19
  ,"                                                                           "   --   20
  ,"                                                                           "   --   21
  ,"                                         .JMN...                           "   --   22
  ,"                                        ..MMMMMMNn,                        "   --   23
  ,"                                     .MMMMMMMMMHUd#                        "   --   24
  ,"                 `  `  `  `  `  `    .NM#MMMMMB#XyR  `  `  `               "   --   25
  ,"                            (Wk..  ` .MM@MMMMMNkM#H,                       "   --   26
  ,"                             (HHW&+ggmMMHMMMMMMM#dkr                       "   --   27
  ,"                `         ..JJMMNMMNMMMNNMMMMMMMQgKX:                      "   --   28
  ,"                  `...+HNQMMNN#SyWMMMMMMMMMMM##BHMMHMHG,  `                "   --   29
  ,"                   qgHMMMMMNNMHMMMNMMNMNHMMNmQe    ?M@Wm-                  "   --   30
  ,"                  7TNMMMMMMMMMNWHHMMMMMMMMMMMNNmNk:w?SdMN,                 "   --   31
  ,"              7HY^ 7'= dNKoJMMBVMMMNMMMNNMNMMNKYWMMMMHMMM'4Nm              "   --   32
  ,"                    `  .-M@NMMNHgNNNMMMNMMMMNMNMWNNgTHNx~.MMH              "   --   33
  ,"                    dMNMMNWN#5MMMHWHMMNMNNMMNMMNMMMNMMmJ, ....             "   --   34
  ,"                     ?TMMMgg,qMNMMNMMMMMMMMMNMMkHNM#WQNm: (WH%             "   --   35
  ,"                `         ''! jNgMMMNMMMmMMNMMMMMHN#B77?                   "   --   36
  ,"                             ....gMMMMMMN8HHMMMMM=                         "   --   37
  ,"                            JMMMMMMMMMMHMMMHMMM                            "   --   38
  ,"                             _TMM=?MMMNQ}`     gMN+                        "   --   39
  ,"                                   (WM#'`      7''`                        "   --   40
  ,"                                                                           "]  --   41
--  123456789012345678901234567890123456789012345678901234567890123456789012345
--           1         2         3         4         5         6         7


